i <- d <- 1
l_CM[[d]][[i]]
l_CM <- readRDS(file = "files/l_CM_60cells.RDS")
l_CM[[d]][[i]]
library(mvtnorm)
mm <- readRDS(file="files/MM_Bringmann.RDS")
mm
mm[[, 1]]
mm[, , 1]
as.numeric(mm[, , 1])
v_w <- rep(NA, 60*100)
counter <- 1
l_CM[[d]][[i]]
v_w <- rep(NA, 60*100)
counter <- 1
dmvnorm(as.numeric(l_CM[[d]][[i]]),
mean = as.numeric(mm[, , 1]),
sigma = diag(as.numeric(mm[, , 2])),
log=FALSE)
v_w <- rep(NA, 60*100)
counter <- 1
for(d in 1:60) {
for(i in 1:100) {
v_w[counter] <- dmvnorm(as.numeric(l_CM[[d]][[i]]),
mean = as.numeric(mm[, , 1]),
sigma = diag(as.numeric(mm[, , 2])),
log=FALSE)
counter <- counter + 1
}
}
plot(v_w)
hist(v_w)
as.numeric(l_CM[[d]][[i]])
as.numeric(mm[, , 1])
x <- as.numeric(l_CM[[d]][[i]]),
v_w[counter] <- dmvnorm(x
mean = as.numeric(mm[, , 1]),
sigma = diag(as.numeric(mm[, , 2])),
log=FALSE)
x <- as.numeric(l_CM[[d]][[i]])
dnorm(x[1], mean = M[1], sd = S[1])
M <- as.numeric(mm[, , 1])
S <- diag(as.numeric(mm[, , 2]))
dnorm(x[1], mean = M[1], sd = S[1])
dnorm(x[1], mean = M[1], sd = S[1])^36
range()
range(v_w)
hist(v_w)
plot(v_w)
par(mfrow=c(1,2))
plot(v_w)
barlpot(cell_weights)
barpllot(cell_weights)
barplot(cell_weights)
# Characteristics of all 9998 stable VAR matrices of initial 10000
out_stable <- readRDS(file = "files/out_stable.RDS")
m_cell_fill <- readRDS(file="files/m_cell_fill.RDS")
# Function to compute cell frq
get_cell <- function(row, p = 6) {
is_within <- function(x, vec) x > vec[1] && x < vec[2]
R <- row[1]
D <- row[2]
cell_pos <- apply(m_cell_fill, 1, function(x) {
cell <- as.numeric(x)
Rbounds <- c(cell[1] - .25, cell[1] + .25)
Dbounds <- c(cell[2] - .025, cell[2] + .025)
is_within(D, Dbounds) && is_within(R, Rbounds)
})
which(cell_pos)
}
out_A <- apply(out_stable, 1, get_cell)
cell_weights <- table(out_A) / length(out_A) # 60 cell weights
barplot(cell_weights)
